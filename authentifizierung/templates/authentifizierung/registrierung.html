{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}Registrierung - llkjj_knut{% endblock %}

{% block extra_css %}
<style>
.registrierung-container {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
}

.welcome-header {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    border-radius: 15px;
    padding: 2rem;
    margin-bottom: 2rem;
}

.registrierung-form {
    background: white;
    border-radius: 10px;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border: 1px solid #e9ecef;
}

.peter-tip {
    border-left: 4px solid #28a745;
    background: #d4edda;
    color: #155724;
    border-radius: 0 10px 10px 0;
}

.form-check {
    margin: 1rem 0;
    padding: 0.75rem;
    background: #f8f9fa;
    border-radius: 8px;
}

.btn-primary {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    border: none;
    border-radius: 25px;
    padding: 12px 24px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3);
}

.password-help {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 1rem;
    margin: 1rem 0;
}

.errorlist {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    border-radius: 8px;
    padding: 0.75rem;
    margin: 0.5rem 0;
    list-style: none;
}

.errorlist li {
    margin: 0;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="registrierung-container">
        
        <div class="welcome-header text-center">
            <h1 class="display-5">üé® Willkommen bei llkjj_knut!</h1>
            <p class="lead mb-0">Ihr pers√∂nlicher Buchhaltungs-Butler wartet auf Sie</p>
        </div>

        <div class="registrierung-form">
            <!-- Template entfernt: Registrierung ist im Single-User-System nicht mehr verf√ºgbar. -->
        </div>

        <!-- Zus√§tzliche Informationen -->
        <div class="mt-4 text-center">
            <div class="alert alert-info">
                <i class="fas fa-shield-alt"></i>
                <strong>Datenschutz & Sicherheit:</strong><br>
                Ihre Daten werden verschl√ºsselt gespeichert und nur f√ºr die Buchhaltung verwendet.
                Peter Zwegat h√§tte es nicht anders gewollt!
            </div>
        </div>

        <!-- Features Preview -->
        <div class="row mt-4">
            <div class="col-md-4 text-center">
                <div class="feature-box p-3">
                    <i class="fas fa-calculator fa-2x text-primary mb-2"></i>
                    <h6>Einfache Buchf√ºhrung</h6>
                    <small class="text-muted">SKR03-Kontenrahmen inklusive</small>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div class="feature-box p-3">
                    <i class="fas fa-file-alt fa-2x text-success mb-2"></i>
                    <h6>E√úR-Erstellung</h6>
                    <small class="text-muted">Automatische Auswertungen</small>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div class="feature-box p-3">
                    <i class="fas fa-robot fa-2x text-warning mb-2"></i>
                    <h6>KI-Unterst√ºtzung</h6>
                    <small class="text-muted">Intelligente Belegerkennung</small>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- JavaScript f√ºr Form-Verbesserungen -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Password Strength Indicator
    const password1 = document.getElementById('id_password1');
    const password2 = document.getElementById('id_password2');
    
    if (password1) {
        password1.addEventListener('input', function() {
            const strength = checkPasswordStrength(this.value);
            updatePasswordStrengthIndicator(strength);
        });
    }
    
    if (password2) {
        password2.addEventListener('input', function() {
            const match = password1.value === this.value;
            updatePasswordMatchIndicator(match);
        });
    }
    
    // E-Mail Validierung
    const emailField = document.getElementById('id_email');
    if (emailField) {
        emailField.addEventListener('blur', function() {
            validateEmailFormat(this.value);
        });
    }
});

function checkPasswordStrength(password) {
    let strength = 0;
    
    // L√§nge
    if (password.length >= 8) strength++;
    if (password.length >= 12) strength++;
    
    // Komplexit√§t
    if (/[a-z]/.test(password)) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/[0-9]/.test(password)) strength++;
    if (/[^A-Za-z0-9]/.test(password)) strength++;
    
    return strength;
}

function updatePasswordStrengthIndicator(strength) {
    // Implementation f√ºr visuelle Passwort-St√§rke-Anzeige
    const colors = ['#dc3545', '#fd7e14', '#ffc107', '#28a745'];
    const labels = ['Schwach', 'M√§√üig', 'Gut', 'Stark'];
    
    // Hier k√∂nnte ein Progress-Bar-Element aktualisiert werden
}

function updatePasswordMatchIndicator(match) {
    const field = document.getElementById('id_password2');
    if (field) {
        if (match) {
            field.style.borderColor = '#28a745';
        } else {
            field.style.borderColor = '#dc3545';
        }
    }
}

function validateEmailFormat(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const field = document.getElementById('id_email');
    
    if (field) {
        if (emailRegex.test(email)) {
            field.style.borderColor = '#28a745';
        } else {
            field.style.borderColor = '#dc3545';
        }
    }
}
</script>
{% endblock %}
